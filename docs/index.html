<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zodiac Mapper | Cosmic Explorer</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
</head>
<body>
    <div class="cosmic-bg">
        <div class="stars"></div>
        <div class="nebula"></div>
    </div>

    <div class="app-container">
        <header>
            <div class="brand">
                <span class="logo-icon">‚ú®</span>
                <h1>Zodiac Mapper</h1>
            </div>
            <p class="tagline">Universal Zodiac Converter & Calculator</p>
            <div class="header-actions">
                <a href="https://github.com/fixicelo/zodiac-mapper" class="github-btn" target="_blank" rel="noopener">
                    <svg height="20" width="20" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                    </svg>
                    <span>GitHub</span>
                </a>
            </div>
        </header>

        <main>
            <div class="glass-panel main-explorer">
                <div class="tabs">
                    <button class="tab-btn active" data-tab="name">üîç By Name</button>
                    <button class="tab-btn" data-tab="date">üìÖ By Date</button>
                </div>

                <div class="tab-content active" id="tab-name">
                    <div class="input-wrapper">
                        <label>Type any zodiac name (e.g. "Aries", "ÁôΩÁæä", "‚ôà")</label>
                        <input type="text" id="text-input" class="cosmic-input" placeholder="Enter sign name...">
                    </div>
                </div>

                <div class="tab-content" id="tab-date">
                    <div class="input-wrapper">
                        <label>Enter date (MM-DD) or pick from calendar</label>
                        <div class="date-input-group">
                            <input type="text" id="date-text-input" class="cosmic-input" placeholder="e.g. 03-21" maxlength="10">
                            <button id="calendar-trigger" class="calendar-btn" title="Open Calendar">üìÖ</button>
                            <input type="date" id="date-picker" class="hidden-picker" title="Date Picker">
                        </div>
                    </div>
                </div>

                <div id="result-display" class="result-display hidden">
                    <div class="result-glow"></div>
                    <div class="result-content">
                        <div class="result-icon"></div>
                        <h2 class="result-name"></h2>
                        <div class="result-date"></div>
                        <div class="result-meta"></div>
                    </div>
                </div>
                
                <div id="empty-state" class="empty-state">
                    <div class="constellation-bg"></div>
                    <p>Select a date or enter a name to reveal the stars.</p>
                </div>
            </div>

            <section class="reference-section">
                <h3>Zodiac Reference Table</h3>
                <div class="table-container">
                    <table class="zodiac-table" id="zodiac-table">
                        <thead>
                            <tr>
                                <th>Sign</th>
                                <th>Date Range</th>
                                <th>English</th>
                                <th>‰∏≠Êñá</th>
                                <th>‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</th>
                                <th>Espa√±ol</th>
                                <th>ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</th>
                                <th>Fran√ßais</th>
                                <th>Portugu√™s</th>
                                <th>–†—É—Å—Å–∫–∏–π</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </section>
        </main>

        <footer>
            <p>Built with <a href="https://github.com/fixicelo/zodiac-mapper">zodiac-mapper</a></p>
        </footer>
    </div>

    <script type="module">
        import { findFirstZodiacInText, getZodiacDateRange, getZodiacSignFromDate, ZodiacSign } from 'https://cdn.jsdelivr.net/npm/zodiac-mapper/dist/index.min.mjs';

        const zodiacInfo = {
            [ZodiacSign.ARIES]: { emoji: "‚ôà", name: "Aries", element: "Fire" },
            [ZodiacSign.TAURUS]: { emoji: "‚ôâ", name: "Taurus", element: "Earth" },
            [ZodiacSign.GEMINI]: { emoji: "‚ôä", name: "Gemini", element: "Air" },
            [ZodiacSign.CANCER]: { emoji: "‚ôã", name: "Cancer", element: "Water" },
            [ZodiacSign.LEO]: { emoji: "‚ôå", name: "Leo", element: "Fire" },
            [ZodiacSign.VIRGO]: { emoji: "‚ôç", name: "Virgo", element: "Earth" },
            [ZodiacSign.LIBRA]: { emoji: "‚ôé", name: "Libra", element: "Air" },
            [ZodiacSign.SCORPIO]: { emoji: "‚ôè", name: "Scorpio", element: "Water" },
            [ZodiacSign.SAGITTARIUS]: { emoji: "‚ôê", name: "Sagittarius", element: "Fire" },
            [ZodiacSign.CAPRICORN]: { emoji: "‚ôë", name: "Capricorn", element: "Earth" },
            [ZodiacSign.AQUARIUS]: { emoji: "‚ôí", name: "Aquarius", element: "Air" },
            [ZodiacSign.PISCES]: { emoji: "‚ôì", name: "Pisces", element: "Water" },
        };

        // Multilingual Data for Reference Table
        const multilingualData = {
            [ZodiacSign.ARIES]: { zh: "ÁôΩÁæäÂ∫ß", hi: "‡§Æ‡•á‡§∑", es: "Aries", ar: "ÿßŸÑÿ≠ŸÖŸÑ", fr: "B√©lier", pt: "√Åries", ru: "–û–≤–µ–Ω" },
            [ZodiacSign.TAURUS]: { zh: "ÈáëÁâõÂ∫ß", hi: "‡§µ‡•É‡§∑‡§≠", es: "Tauro", ar: "ÿßŸÑÿ´Ÿàÿ±", fr: "Taureau", pt: "Touro", ru: "–¢–µ–ª–µ—Ü" },
            [ZodiacSign.GEMINI]: { zh: "ÂèåÂ≠êÂ∫ß", hi: "‡§Æ‡§ø‡§•‡•Å‡§®", es: "G√©minis", ar: "ÿßŸÑÿ¨Ÿàÿ≤ÿßÿ°", fr: "G√©meaux", pt: "G√™meos", ru: "–ë–ª–∏–∑–Ω–µ—Ü—ã" },
            [ZodiacSign.CANCER]: { zh: "Â∑®ËüπÂ∫ß", hi: "‡§ï‡§∞‡•ç‡§ï", es: "C√°ncer", ar: "ÿßŸÑÿ≥ÿ±ÿ∑ÿßŸÜ", fr: "Cancer", pt: "C√¢ncer", ru: "–†–∞–∫" },
            [ZodiacSign.LEO]: { zh: "ÁãÆÂ≠êÂ∫ß", hi: "‡§∏‡§ø‡§Ç‡§π", es: "Leo", ar: "ÿßŸÑÿ£ÿ≥ÿØ", fr: "Lion", pt: "Le√£o", ru: "–õ–µ–≤" },
            [ZodiacSign.VIRGO]: { zh: "Â§ÑÂ•≥Â∫ß", hi: "‡§ï‡§®‡•ç‡§Ø‡§æ", es: "Virgo", ar: "ÿßŸÑÿπÿ∞ÿ±ÿßÿ°", fr: "Vierge", pt: "Virgem", ru: "–î–µ–≤–∞" },
            [ZodiacSign.LIBRA]: { zh: "Â§©Áß§Â∫ß", hi: "‡§§‡•Å‡§≤‡§æ", es: "Libra", ar: "ÿßŸÑŸÖŸäÿ≤ÿßŸÜ", fr: "Balance", pt: "Libra", ru: "–í–µ—Å—ã" },
            [ZodiacSign.SCORPIO]: { zh: "Â§©ËùéÂ∫ß", hi: "‡§µ‡•É‡§∂‡•ç‡§ö‡§ø‡§ï", es: "Escorpio", ar: "ÿßŸÑÿπŸÇÿ±ÿ®", fr: "Scorpion", pt: "Escorpi√£o", ru: "–°–∫–æ—Ä–ø–∏–æ–Ω" },
            [ZodiacSign.SAGITTARIUS]: { zh: "Â∞ÑÊâãÂ∫ß", hi: "‡§ß‡§®‡•Å", es: "Sagitario", ar: "ÿßŸÑŸÇŸàÿ≥", fr: "Sagittaire", pt: "Sagit√°rio", ru: "–°—Ç—Ä–µ–ª–µ—Ü" },
            [ZodiacSign.CAPRICORN]: { zh: "Êë©ÁæØÂ∫ß", hi: "‡§Æ‡§ï‡§∞", es: "Capricornio", ar: "ÿßŸÑÿ¨ÿØŸä", fr: "Capricorne", pt: "Capric√≥rnio", ru: "–ö–æ–∑–µ—Ä–æ–≥" },
            [ZodiacSign.AQUARIUS]: { zh: "Ê∞¥Áì∂Â∫ß", hi: "‡§ï‡•Å‡§Ç‡§≠", es: "Acuario", ar: "ÿßŸÑÿØŸÑŸà", fr: "Verseau", pt: "Aqu√°rio", ru: "–í–æ–¥–æ–ª–µ–π" },
            [ZodiacSign.PISCES]: { zh: "ÂèåÈ±ºÂ∫ß", hi: "‡§Æ‡•Ä‡§®", es: "Piscis", ar: "ÿßŸÑÿ≠Ÿàÿ™", fr: "Poissons", pt: "Peixes", ru: "–†—ã–±—ã" },
        };

        function formatDateRange(range) {
            const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
            const start = `${months[range.start.month - 1]} ${range.start.day}`;
            const end = `${months[range.end.month - 1]} ${range.end.day}`;
            return `${start} - ${end}`;
        }

        // Tab Switching
        const tabs = document.querySelectorAll('.tab-btn');
        const contents = document.querySelectorAll('.tab-content');
        
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => { t.classList.remove('active'); });
                contents.forEach(c => { c.classList.remove('active'); });
                tab.classList.add('active');
                document.getElementById(`tab-${tab.dataset.tab}`).classList.add('active');
                
                // Clear inputs when switching
                document.getElementById('date-input').value = '';
                document.getElementById('text-input').value = '';
                hideResult();
            });
        });

        // Result Display Logic
        const resultDisplay = document.getElementById('result-display');
        const emptyState = document.getElementById('empty-state');

        function showResult(sign, metaText = '') {
            const info = zodiacInfo[sign];
            const range = getZodiacDateRange(sign);
            
            resultDisplay.querySelector('.result-icon').textContent = info.emoji;
            resultDisplay.querySelector('.result-name').textContent = info.name;
            resultDisplay.querySelector('.result-date').textContent = formatDateRange(range);
            resultDisplay.querySelector('.result-meta').textContent = metaText || info.element;
            
            // Set color theme based on element
            resultDisplay.setAttribute('data-element', info.element.toLowerCase());

            resultDisplay.classList.remove('hidden');
            emptyState.classList.add('hidden');
        }

        function hideResult() {
            resultDisplay.classList.add('hidden');
            emptyState.classList.remove('hidden');
        }

        // Date Input Logic (Text + Picker)
        const dateTextInput = document.getElementById('date-text-input');
        const datePicker = document.getElementById('date-picker');
        const calendarBtn = document.getElementById('calendar-trigger');

        // 1. Handle Text Input
        dateTextInput.addEventListener('input', (e) => {
            const val = e.target.value.trim();
            // Allow clearing
            if (!val) return hideResult();
            
            // Try to parse if it looks like MM-DD or YYYY-MM-DD
            // Simple regex check to avoid throwing too many errors on partial input
            if (/^\d{1,2}-\d{1,2}$/.test(val) || /^\d{4}-\d{1,2}-\d{1,2}$/.test(val)) {
                try {
                    const sign = getZodiacSignFromDate(val);
                    showResult(sign);
                } catch (_err) {
                    // Ignore incomplete/invalid dates while typing
                }
            }
        });

        // 2. Handle Calendar Button
        calendarBtn.addEventListener('click', () => {
            // Show picker
            try {
                datePicker.showPicker(); 
            } catch (_e) {
                // Fallback for browsers not supporting showPicker (e.g. older Safari)
                datePicker.click();
            }
        });

        // 3. Handle Picker Change
        datePicker.addEventListener('change', (e) => {
            const val = e.target.value; // YYYY-MM-DD
            if (val) {
                // Extract MM-DD to show in text input (cleaner)
                const [_y, m, d] = val.split('-');
                const cleanDate = `${m}-${d}`;
                dateTextInput.value = cleanDate;
                
                // Trigger search
                try {
                    const sign = getZodiacSignFromDate(cleanDate);
                    showResult(sign);
                } catch (err) {
                    console.error(err);
                }
            }
        });

        // Text Input
        document.getElementById('text-input').addEventListener('input', (e) => {
            const val = e.target.value;
            if (!val.trim()) return hideResult();
            
            const match = findFirstZodiacInText(val);
            if (match) {
                showResult(match.sign, `Matched: "${match.match}"`);
            } else {
                hideResult();
            }
        });

        // Table Population
        const tableBody = document.querySelector('#zodiac-table tbody');
        Object.values(ZodiacSign).forEach(sign => {
            const info = zodiacInfo[sign];
            const multi = multilingualData[sign];
            const range = getZodiacDateRange(sign);
            
            const row = document.createElement('tr');
            row.innerHTML = `
                <td class="col-sign"><span class="table-icon">${info.emoji}</span></td>
                <td class="col-date">${formatDateRange(range)}</td>
                <td class="col-lang">${info.name}</td>
                <td class="col-lang">${multi.zh}</td>
                <td class="col-lang">${multi.hi}</td>
                <td class="col-lang">${multi.es}</td>
                <td class="col-lang">${multi.ar}</td>
                <td class="col-lang">${multi.fr}</td>
                <td class="col-lang">${multi.pt}</td>
                <td class="col-lang">${multi.ru}</td>
            `;
            
            tableBody.appendChild(row);
        });
    </script>
</body>
</html>
